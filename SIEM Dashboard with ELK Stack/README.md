# Project 3: SIEM Dashboard with ELK Stack

This project implements a Security Information and Event Management (SIEM) system using the **Elastic Stack (ELK)**. It is designed to ingest, parse, store, and visualize security logs for threat detection.

## üèóÔ∏è Architecture

The implementation follows the blueprint provided, using **Docker Compose** for orchestrating the services:

1.  **Elasticsearch** (Single Node for Dev/Test):
    -   Stores all security logs.
    -   Configured with **Index Lifecycle Management (ILM)** policies to simulate Hot/Warm/Cold tiering.
2.  **Logstash**:
    -   **Input**: Listens on port `5044` (Beats) and `5000` (Syslog TCP/UDP).
    -   **Filter**: fast parsing with Grok, ECS (Elastic Common Schema) mapping, and GeoIP enrichment placeholders.
    -   **Output**: Sends processed logs to Elasticsearch.
3.  **Kibana**:
    -   Web interface for visualizing data and managing the stack (Port `5601`).

---

## üöÄ Getting Started

### Prerequisites
-   **Docker Desktop** installed and running.
-   **Python 3.x** (simulating log traffic and setup).

### 1. Launch the Stack
Run the following command at the root of the project to start all services:
```bash
docker-compose up -d
```
Wait for 1-2 minutes for Elasticsearch and Kibana to initialize. You can check status with:
```bash
docker-compose ps
```

### 2. Configure Elasticsearch (ILM & Templates)
We have a script to automatically apply the "Blueprint" configurations (ILM policies for Hot/Warm tiers and Index settings):
```bash
python scripts/setup_siem.py
```
*Wait until you see "SIEM Setup complete".*

### 3. Generate Sample Data
To test the SIEM immediately without setting up external servers, run the log generator:
```bash
python scripts/generate_logs.py
```
This script acts like a server sending system and auth logs to Logstash on port 5000. Keep it running to see live data.

---

## üìä Using the Dashboard (Kibana)

1.  Open your browser to: **[http://localhost:5601](http://localhost:5601)**
2.  **Create a Data View**:
    -   Go to **Stack Management** > **Data Views**.
    -   Click **Create data view**.
    -   Name: `SIEM Logs`
    -   Index pattern: `siem-logs-*`
    -   Timestamp field: `@timestamp`
    -   Click **Save data view**.
3.  **Explore Logs**:
    -   Go to **Discover**.
    -   Select `SIEM Logs`.
    -   You should see the logs generated by the script!
4.  **Visualize**:
    -   Go to **Dashboard** > **Create Dashboard**.
    -   Add a **Lens** visualization.
    -   Try dropping `event.dataset` or `host.hostname` to see a breakdown of events.

---

## üõ†Ô∏è Configuration Details

### Logstash Pipeline (`logstash/pipeline/main.conf`)
-   Parses `syslog` format using Grok.
-   Maps fields to ECS (e.g., `host.hostname`).
-   Tags "Threats" (Simulated logic: marks specific IPs as malicious).

### Elasticsearch ILM
-   **Hot Phase**: Active writing.
-   **Warm Phase**: Moves here after 1 day (simulated).
-   **Delete**: After 30 days.

## üõ°Ô∏è Security Note
This implementation runs with `xpack.security.enabled=false` for easy local demonstration. For a production deployment, you **must**:
1.  Enable Security in `elasticsearch.yml` and `kibana.yml`.
2.  Generate passwords using `elasticsearch-setup-passwords`.
3.  Configure TLS for transport and HTTP layers.

---
**Project Outcome**: A functional real-time dashboard foundation capable of scaling to support Beats, Wazuh, and Cloud logs as per the blueprint.
